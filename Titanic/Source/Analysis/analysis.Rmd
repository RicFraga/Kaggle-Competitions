---
title: "Titanic Passengers' Data Pre-Processing"
author: "Ricardo Alcaraz Fraga"
date: "10/20/2020"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
library(ggplot2)
train_data <- read.csv('/home/fraga/Documents/Kaggle Competitions/Titanic/Data/titanic/train.csv')
knitr::opts_chunk$set(echo = TRUE)
```

## Getting to Know the Situation
The RMS Titanic was a British passenger liner operated by the White Star Line 
and known by a lot of people, mainly because the 1997 movie starred by Kate 
Winslet and Leonardo DiCaprio and for being one of the worst naval disasters.  

Titanic was the largest ship afloat at the time she entered service and was the 
second of three Olympic-class ocean liners operated by the White Star Line. She 
was built in by the Harland and Wolf shipyard in Belfast. Thomas Andrews, chief 
naval architect of the shipyard at the time, died in the disaster.  

The ocean liner carried some of the wealthiest people in the world, as well as 
hundreds of emigrants from Great Britain and Ireland and Scandinavia, who were 
seeking a new life in the United States of America.  

Titanic left Southampton on 10 April 1921, she called at Cherbourg in France and 
Queenstown in Ireland, before heading west to New York and finally sinking in 
the early morning hours of 15 April 1912 after striking an iceberg.

## How Bad was It?
We all agree that the sinking of Titanic was a great tragedy, but, how does it 
compare to other ship sinkings? I gathered some data about other famous ships, 
the amount of passengers and the amount of deceased people, take a look at it.  

```{r Comparision Data Set, echo = FALSE}
ships <- data.frame(name = c('HMS Erebus & HMS Terror', 
                             'RMS Titanic', 
                             'RMS Lusitana',
                             'HMHMS Brittanic',
                             'Bismarck',
                             'Wilhelm Gustloff',
                             'Costa Concordia'), 
                    year = c(1846, 1912, 1915, 1926, 1941, 1945, 2012),
                    aboard = c(128, 2208, 1959, 1125, 2200, 10600, 4200),
                    deceased = c(128, 1503, 1198, 29, 2086, 9343, 32))

print(head(ships))
```

So, from this data let's create a new data frame containing the ship name and 
percentage of deceased people.

```{r Percentage of Deceased, echo = FALSE, fig.width = 15, fig.height = 4}
deceased = data.frame(name = ships[, 'name'], 
                      deceased_p = ships[, 'deceased'] * 100 / ships[, 'aboard'])

ggplot(deceased, aes(x = name, y = deceased_p)) +
  geom_segment(aes(x = name, xend = name, y = 0, yend = deceased_p), 
               size = 1, color = 'blue', linetype = 'dotdash') + 
  geom_point() + 
  labs(y = 'Percentage of Deceased Passengers', x = NULL)
```

We can see that there are "worst" outcomes when it comes to sink history, but 
the comparison has one fatal flaw, the top 3 ships were from military use, so 
it is not a fair comparison. Nevertheless, all of them are tragic as it were 
human lives that were lost.  


## Taking a Look at the Data Set
Let's start simple, how many rows and columns we have and how many NAs are there?

```{r First Approach}
head(train_data)
names(train_data)
dim(train_data)
colSums(is.na.data.frame(train_data[, ]))
```

We can see that we have 177 missing values in the column Age, this means that 
from the total rows, 19.8% are incomplete. We can also see that we have 12 
columns and that some of them have a not numerical value, like the name column. 
Let's start modifying the data, we'll convert age into a numerical value.  

* Female = 1  
* Male = 0  

```{r Encoding Sex, echo =  FALSE}
sex <- train_data[, 'Sex']
encoded_sex <- c()

for(i in 1:length(sex)) {
  if(sex[i] == 'female') {
    encoded_sex <- c(encoded_sex, 1)
  }
  
  else if(sex[i] == 'male'){
    encoded_sex <- c(encoded_sex, 0)
  }
}

train_data[, 'Sex'] <- encoded_sex
head(train_data[, c('Name', 'Sex')], 10)
```

Now that we fixed that, let's compare how many women survived vs how many people 
survived.

```{r Survived vs Deceased, echo = FALSE}
survived <- which(train_data[, 'Survived'] == 1)
male_s <- which(train_data[survived, 'Sex'] == 0)
female_s <- which(train_data[survived, 'Sex'] == 1)

print("Total survivors: ")
print(length(survived))

print("Percentage of women who survived: ")
print(length(female_s) * 100 / length(survived))

print("Percentage of men who survived: ")
print(length(male_s) * 100 / length(survived))
```


